# mp4Label 视频标注工具 - 详细使用教程

## 目录

1. [工具简介](#工具简介)
2. [快速开始](#快速开始)
3. [详细使用步骤](#详细使用步骤)
4. [高级功能](#高级功能)
5. [常见问题](#常见问题)

---

## 工具简介

mp4Label 是一款专业的视频标注工具，专门用于标注视频剪辑教程。它可以帮助您：

- 📹 快速浏览和管理视频文件
- ⏱️ 精确标注教程的关键步骤时间点
- ✏️ 编辑和整理教程步骤说明
- 💾 保存标注结果供后续使用

### 主要特点

- ✅ **单文件运行**：只需一个可执行文件，无需安装其他依赖
- ✅ **跨平台支持**：支持 Windows、macOS、Linux
- ✅ **精确时间戳**：支持毫秒级精度的时间标注
- ✅ **快捷键操作**：支持键盘快捷键，提高标注效率
- ✅ **预标注支持**：可以加载和编辑 AI 生成的预标注文件

---

## 快速开始

### 第一步：获取程序文件

根据您的操作系统，选择对应的可执行文件：

- **Windows 用户**：`mp4label.exe`
- **macOS 用户**：`mp4label` 或 `mp4label-darwin`
- **Linux 用户**：`mp4label-linux`

> 💡 **提示**：您只需要这一个文件即可运行，无需安装其他软件。

### 第二步：启动程序

#### Windows 用户

1. 双击 `mp4label.exe` 文件，或在命令行中运行：
   ```bash
   mp4label.exe web
   ```

#### macOS/Linux 用户

1. 打开终端（Terminal）
2. 进入程序所在目录
3. 运行以下命令：
   ```bash
   ./mp4label web
   ```
   
   > 💡 **提示**：如果是第一次运行，可能需要给程序添加执行权限：
   > ```bash
   > chmod +x mp4label
   > ```

### 第三步：打开浏览器

程序启动后，您会看到类似以下信息：

```
mp4Label 服务器已启动
访问地址: http://localhost:8080
```

1. 打开您的浏览器（推荐使用 Chrome、Firefox 或 Edge）
2. 在地址栏输入：`http://localhost:8080`
3. 按回车键访问

> ⚠️ **注意**：请保持终端窗口打开，关闭终端窗口会停止程序运行。

---

## 详细使用步骤

### 步骤 1：首次配置

第一次使用时，需要配置必要的路径信息。

#### 1.1 打开配置界面

1. 在浏览器中打开 mp4Label 后，您会看到主界面
2. 点击右上角的 **"Config"** 按钮
3. 配置对话框会弹出

#### 1.2 设置视频目录

1. 在 **"Video Directory"**（视频目录）输入框中，输入您存放视频文件的文件夹路径
   - 例如：`C:\Videos\Tutorials`（Windows）
   - 例如：`/Users/username/Videos`（macOS）
   - 例如：`/home/username/videos`（Linux）

2. 这个目录应该包含您要标注的 `.mp4` 视频文件

> 💡 **提示**：您可以直接从文件管理器复制文件夹路径，然后粘贴到输入框中。

#### 1.3 设置输出目录

1. 在 **"Output Directory"**（输出目录）输入框中，输入您希望保存标注结果的文件夹路径
   - 例如：`C:\Videos\Annotations`（Windows）
   - 例如：`/Users/username/Annotations`（macOS）

2. 这个目录用于保存您标注完成后的文件

> ⚠️ **注意**：请确保输出目录存在，如果不存在请先创建该文件夹。

#### 1.4 设置预标注目录（可选）

如果您有 AI 生成的预标注文件，可以设置 **"Pre-annotation Directory"**（预标注目录）：

1. 在输入框中输入预标注文件所在的文件夹路径
2. 如果暂时没有预标注文件，可以留空

#### 1.5 设置任务文件（可选）

如果您只想标注特定的视频文件，可以设置 **"Task File"**（任务文件）：

1. 创建一个文本文件（`.txt` 格式）
2. 在文件中每行写一个视频文件名（不需要 `.mp4` 扩展名）
   ```
   video1
   video2
   tutorial_intro
   ```
3. 在配置对话框中输入这个文本文件的完整路径

#### 1.6 保存配置

1. 检查所有路径是否正确
2. 点击 **"Save"**（保存）按钮
3. 配置会自动保存，下次启动程序时会自动加载

> 💡 **提示**：配置信息保存在 `~/.mp4label/config.json`，您可以随时修改。

---

### 步骤 2：选择视频

配置完成后，主界面会显示视频列表。

#### 2.1 查看视频列表

1. 左侧边栏会显示所有找到的视频文件
2. 每个视频会显示：
   - **编号**：自动生成的序号（如 #0001）
   - **文件名**：视频文件的名称
   - **状态标识**：
     - 🟡 **Pre-annotated**：有预标注文件
     - 🟢 **Annotated**：已标注完成
     - 🔴 **None**：未标注

#### 2.2 搜索视频

如果视频很多，可以使用搜索功能：

1. 在视频列表上方的搜索框中输入关键词
2. 视频列表会实时过滤，只显示匹配的视频

#### 2.3 过滤视频

使用过滤按钮可以快速筛选视频：

- **All**：显示所有视频
- **None**：只显示未标注的视频
- **Pre**：只显示有预标注但未完成的视频
- **Done**：只显示已标注完成的视频

#### 2.4 选择视频

1. 在视频列表中点击您要标注的视频
2. 视频会在中间的播放器中加载
3. 右侧的标注编辑器会显示该视频的标注信息（如果有）

---

### 步骤 3：开始标注

#### 3.1 输入教程标题

1. 在右侧标注编辑器的 **"Tutorial Title"**（教程标题）输入框中
2. 输入这个教程的标题
   - 例如："电影滚动字幕制作教程"
   - 例如："高级感变速卡点效果"

#### 3.2 播放视频

1. 点击视频播放器中的播放按钮，或按键盘上的 **空格键** 开始播放
2. 观看视频内容，了解教程的整体流程

#### 3.3 插入时间戳

当视频播放到关键步骤时，有多种方式插入时间戳：

**方法一：使用快捷键（推荐）**

1. 当视频播放到关键步骤时，按键盘上的 **`I`** 键
2. 视频会自动暂停
3. 系统会自动创建一个新的步骤，并填入当前时间戳
4. 光标会自动定位到描述输入框

**方法二：使用按钮**

1. 当视频播放到关键步骤时，点击播放器下方的 **"⏱ Insert Timestamp"**（插入时间戳）按钮
2. 效果与按 `I` 键相同

**方法三：手动添加**

1. 点击右侧编辑器中的 **"Add Step"**（添加步骤）按钮
2. 手动输入时间戳和描述

#### 3.4 输入步骤描述

1. 插入时间戳后，在步骤的 **"Description"**（描述）输入框中
2. 输入这个步骤的说明文字
   - 例如："导入素材到编辑软件"
   - 例如："调整视频播放速度到 0.5 倍"
   - 例如："添加转场效果"

#### 3.5 继续标注

1. 输入完描述后，按 **空格键** 继续播放视频
2. 重复步骤 3.3 和 3.4，标注所有关键步骤
3. 直到视频结束或所有重要步骤都已标注

---

### 步骤 4：编辑和调整标注

#### 4.1 验证时间戳

1. 在右侧的步骤列表中，点击任意步骤的 **时间戳**（如 `00:11.230`）
2. 视频会自动跳转到该时间点并暂停
3. 检查时间戳是否准确，如果不准确可以手动修改

#### 4.2 修改时间戳

1. 直接点击时间戳输入框
2. 修改时间格式为：`mm:ss.SSS`（分钟:秒.毫秒）
   - 例如：`00:11.230` 表示 11 秒 230 毫秒
   - 例如：`01:23.456` 表示 1 分 23 秒 456 毫秒
3. 修改后，可以点击时间戳验证位置

#### 4.3 修改步骤描述

1. 直接点击描述输入框
2. 修改文字内容
3. 可以随时修改，直到保存前

#### 4.4 删除步骤

1. 找到要删除的步骤
2. 点击步骤右上角的 **`×`** 按钮
3. 步骤会被删除，其他步骤的编号会自动更新

#### 4.5 调整步骤顺序

1. 找到要移动的步骤
2. 点击步骤左侧的拖拽手柄（`⋮⋮` 图标）
3. 按住鼠标左键，拖动到目标位置
4. 松开鼠标，步骤会移动到新位置
5. 步骤编号会自动重新排序

---

### 步骤 5：保存标注

#### 5.1 检查标注内容

保存前，建议检查：

- ✅ 教程标题已填写
- ✅ 所有步骤的时间戳准确
- ✅ 所有步骤的描述清晰完整
- ✅ 步骤顺序正确

#### 5.2 标记非教程视频

如果这个视频不是教程视频，可以：

1. 勾选右侧编辑器底部的 **"Non-tutorial"**（非教程）复选框
2. 这样保存的文件会包含 `[not tutorial]` 标记

#### 5.3 保存文件

1. 点击右上角的 **"Save"**（保存）按钮
2. 系统会验证标注格式
3. 如果格式正确，文件会保存到您配置的输出目录
4. 保存成功后，视频列表中的状态会更新为 **🟢 Annotated**

> 💡 **提示**：保存的文件名与视频文件名相同，扩展名为 `.txt`。

---

### 步骤 6：编辑预标注文件

如果您有 AI 生成的预标注文件，可以加载并编辑：

#### 6.1 加载预标注

1. 选择有预标注的视频（显示 🟡 Pre-annotated 标识）
2. 视频加载后，预标注内容会自动显示在右侧编辑器
3. 包括标题和所有步骤

#### 6.2 验证和修正

1. 逐个点击步骤的时间戳，验证准确性
2. 修正不准确的时间戳
3. 修改或完善步骤描述
4. 删除多余的步骤
5. 添加缺失的步骤

#### 6.3 保存修正结果

1. 完成所有修正后，点击 **"Save"** 按钮
2. 修正后的标注会覆盖预标注文件

---

## 高级功能

### 视频播放控制

#### 播放速度调整

1. 在视频播放器下方，找到 **"Speed"**（速度）下拉菜单
2. 选择播放速度：
   - `0.5x`：慢速播放，适合精确标注
   - `0.75x`：稍慢，适合仔细观看
   - `1x`：正常速度
   - `1.25x`、`1.5x`、`2x`：快速播放，适合快速浏览

> 💡 **推荐**：
> - 首次观看：使用 `1x` 正常速度
> - 精确标注：使用 `0.75x` 或 `0.5x` 慢速
> - 快速浏览：使用 `1.5x` 或 `2x` 快速

#### 全屏播放

1. 双击视频播放器，或点击全屏按钮
2. 按 `Esc` 键退出全屏

#### 音量控制

1. 点击播放器上的音量图标
2. 拖动滑块调整音量

### 键盘快捷键

mp4Label 支持多种键盘快捷键，提高操作效率：

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `空格键` | 播放/暂停 | 在视频播放时暂停，暂停时播放 |
| `←` 左箭头 | 后退 0.5 秒 | 精确调整到前一帧 |
| `→` 右箭头 | 前进 0.5 秒 | 精确调整到后一帧 |
| `I` | 插入时间戳 | 在当前播放位置插入新步骤 |

> ⚠️ **注意**：快捷键在输入框中不会生效，这是为了避免误操作。需要先点击输入框外的区域。

### 复制时间戳

1. 在视频播放器下方，会显示当前播放时间
2. 点击这个时间显示
3. 时间戳会自动复制到剪贴板
4. 显示 "Copied!" 提示

### 统计信息

在主界面顶部，会显示统计信息：

- **Total**：视频总数
- **Annotated**：已标注数量
- **Pre-annotated**：有预标注数量
- **Unannotated**：未标注数量

这些信息帮助您了解标注进度。

---

## 常见问题

### 问题 1：程序无法启动

**可能原因：**
- 文件权限问题（macOS/Linux）
- 端口 8080 被占用

**解决方法：**

**macOS/Linux 权限问题：**
```bash
chmod +x mp4label
```

**端口被占用：**
- 关闭占用 8080 端口的其他程序
- 或修改程序代码使用其他端口（需要重新编译）

### 问题 2：视频列表为空

**可能原因：**
- 视频目录路径错误
- 目录中没有 `.mp4` 文件
- 目录权限不足

**解决方法：**
1. 检查配置中的视频目录路径是否正确
2. 确认目录中确实有 `.mp4` 文件
3. 检查目录是否有读取权限

### 问题 3：视频无法播放

**可能原因：**
- 视频文件损坏
- 视频格式不支持
- 浏览器不支持该视频编码

**解决方法：**
1. 尝试用其他视频播放器打开，确认文件正常
2. 确保视频是 MP4 格式
3. 尝试使用其他浏览器（Chrome、Firefox）

### 问题 4：标注无法保存

**可能原因：**
- 输出目录路径错误
- 输出目录不存在
- 输出目录没有写入权限
- 标注格式错误

**解决方法：**
1. 检查配置中的输出目录路径
2. 确认输出目录存在，如果不存在请先创建
3. 检查目录是否有写入权限
4. 检查时间戳格式是否正确（`mm:ss.SSS`）
5. 确保所有步骤都有描述文字

### 问题 5：快捷键不工作

**可能原因：**
- 光标在输入框中
- 浏览器焦点问题

**解决方法：**
1. 先点击输入框外的区域，确保焦点不在输入框
2. 刷新浏览器页面（`Ctrl+F5` 或 `Cmd+Shift+R`）
3. 确保视频已加载

### 问题 6：时间戳跳转不准确

**可能原因：**
- 时间戳格式错误
- 视频未完全加载

**解决方法：**
1. 检查时间戳格式是否为 `mm:ss.SSS`
2. 等待视频完全加载后再点击时间戳
3. 刷新页面重试

### 问题 7：预标注文件未加载

**可能原因：**
- 预标注目录路径错误
- 预标注文件名与视频文件名不匹配

**解决方法：**
1. 检查配置中的预标注目录路径
2. 确保预标注文件名与视频文件名相同（扩展名不同）
   - 视频：`tutorial.mp4`
   - 预标注：`tutorial.txt`

### 问题 8：任务文件不生效

**可能原因：**
- 任务文件路径错误
- 任务文件中的视频名与文件名不匹配

**解决方法：**
1. 检查任务文件路径是否正确
2. 确保任务文件中的视频名与实际的视频文件名匹配（不包括 `.mp4` 扩展名）
3. 确保每行只有一个视频名
4. 空行会被自动忽略

---

## 标注文件格式说明

### 教程视频格式

保存的标注文件格式如下：

```
教程标题

1) 00:11.230 第一步的描述
2) 00:25.560 第二步的描述
3) 00:42.890 第三步的描述
```

**格式要求：**
- 第一行：教程标题（不能为空）
- 空行
- 每行一个步骤：`序号) 时间戳 描述`
- 时间戳格式：`mm:ss.SSS`（分钟:秒.毫秒）

### 非教程视频格式

如果勾选了 "Non-tutorial" 选项，文件内容为：

```
[not tutorial]
```

---

## 使用技巧

### 技巧 1：高效标注流程

1. **第一次观看**：以正常速度（1x）完整观看视频，了解整体内容
2. **第二次标注**：以慢速（0.75x 或 0.5x）播放，使用 `I` 键快速插入时间戳
3. **第三次验证**：逐个点击时间戳，验证准确性并完善描述

### 技巧 2：精确时间定位

1. 使用 `←` 和 `→` 箭头键进行 0.5 秒的微调
2. 结合播放速度调整，可以精确定位到关键帧

### 技巧 3：批量处理

1. 使用任务文件功能，将视频分批标注
2. 使用状态过滤，优先处理未标注的视频
3. 利用搜索功能，快速找到特定视频

### 技巧 4：预标注优化

1. 加载预标注后，先快速浏览所有步骤
2. 使用时间戳跳转功能，验证每个步骤的准确性
3. 只修正不准确的部分，提高效率

---

## 总结

mp4Label 是一款简单易用的视频标注工具，通过本教程，您应该能够：

- ✅ 正确配置和使用工具
- ✅ 高效地标注视频教程
- ✅ 编辑和调整标注内容
- ✅ 处理预标注文件
- ✅ 解决常见问题

如果您在使用过程中遇到其他问题，请参考程序的文档或联系技术支持。

**祝您使用愉快！** 🎬✨
